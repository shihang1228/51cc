<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
    <!--头部公共部分-->
<include file="User/header2" />
<link href="http://www.zhaosuliao.com/resources/fore/css/member.css?v=20151030" rel="stylesheet" type="text/css" />
<div class="top">
    <div class="top_t">
        <div class="w960">
            <div class="r">
                您好，<span class="color">{$userdata['username']}({$userdata['phone']})</span><a href="{:U('Home/User/logout')}" class="logout" data-url="{:U('Home/Index/index')}">【退出】</a>&nbsp;&nbsp;<i>|</i>&nbsp;&nbsp;<span>交易热线：<span >020-83939808</span></span>&nbsp;&nbsp;<i>|</i>&nbsp;&nbsp;交易时间：工作日 9:00-17:30
            </div>
            <a class="font_14" href="{:U('Home/Index/index')}" target="_blank">回到首页</a>&nbsp;&nbsp;<i>|</i>&nbsp;&nbsp;<a class="font_14" href="{:U('Home/User/member')}">会员中心</a>
        </div>
    </div>
    <div class="logo">
        <div class="w960" style=" overflow:hidden;">
            <img src="http://www.zhaosuliao.com/resources/fore/image/member/member_logo.png" title="找磁材网" alt="找磁材网logo"/>
        </div>
    </div>
</div><script>
	$(function(){
		/*
		$('#member_submit').click(function(){
			var options = { 
			        beforeSubmit:  showRequest,  // pre-submit callback 
			        success:       showResponse,  // post-submit callback 
					url:       'http://www.zhaosuliao.com/member/password/update',
					type:      'post',
					dataType:  'json',
					clearForm: false,
					timeout:   6000
				};
				$('#myform').ajaxSubmit(options); 
		});*/
		
		
		// $("#myform").validate({
		// 	 rules: {
		// 		 	old_password :{
		// 				 required : true,
		// 				 remote:{
		// 					    url: "http://www.zhaosuliao.com/member/isPasswordCorrect",//后台处理程序
		// 					    type: "GET",               	//数据发送方式
		// 					    dataType: "json",           //接受数据格式   
		// 					    data: {						//要传递的数据
		// 					    	"oldPassword":function(){
		// 					    		return $('#old_pwd').val()              
		// 					    	}
		// 				    	}
		// 				  }
		// 		 	},
		// 		 	new_password: {
		// 		 		required : true,
		// 				noEqualTo :"#old_pwd"
		// 		 	},
		// 		    new_password_confirm: {
		// 		      equalTo: "#new_pwd"
		// 		    }
		// 	 },
		// 	  messages:{
		// 		  old_password :{
		// 			  remote : "旧密码不正确"
		// 		  },	
		// 		  new_password : {
		// 			noEqualTo: "新密码不能跟旧密码一样"
		// 		}
					
		// 	  },
		// 		//设置验证成功提示格式
		//       success:function(e)
		//       {
		//          	e.html("&nbsp;").addClass("ok");
		//       },
		//       submitHandler: function(form) {
		//     	  $.post("http://www.zhaosuliao.com/member/password/update",$("#myform").serialize(),function(rs) {
		// 	            if(rs.status<0){
		// 	            	alert(rs.msg);
		// 	            }
		// 	            else{
		// 	            	alert(rs.msg);
		// 	            	location.href="http://www.zhaosuliao.com/member";
		// 	            }
		// 	        },"json");
		//   	  }	 
		// })
	});

	/*function showRequest(formData, jqForm, options) {
		var old_pwd=$("#old_pwd").val();
		var new_pwd=$("#new_pwd").val();
		var confirm_pwd=$("#confirm_pwd").val();
		if(old_pwd=='' || old_pwd==null){
			$("#error").html("旧密码不能为空");
			$("#old_pwd").focus();
			return false;
		}
		if(!new_pwd){
			$("#error").html("请输入新密码");
			$("#new_pwd").focus();
			return false;
		}
		if(new_pwd.length<6 || new_pwd.length>16){
			$("#error").html("密码长度只能是6-16位字符之间");
			$("#new_pwd").focus();
			return false;
		}
		if(new_pwd==old_pwd){
			$("#error").html("新密码不能跟旧密码一样");
			$("#new_pwd").focus();
			return false;
		}
		if(new_pwd!=confirm_pwd){
			$("#error").html("两次输入密码不相同");
			$("#confirm_pwd").focus();
			return false;
		}
		$("#error").html("");
	    return true; 
	} 

	function showResponse(responseText, statusText, xhr, $form)  { 
		if(responseText.status<0)
	    {
	        alert(responseText.msg);
	    }
	    else
	    {
	        alert(responseText.msg);
	        location.href="http://www.zhaosuliao.com/logout";
	    }
	}
	*/
</script>
  <div class="member_wrap" >
	<div class="member_content" >
<!--左侧公共部分-->
        <include file="User/left" />
	<div class="right index">
			<div class="pulic_title">
				<i class="icon"></i>
				<span>修改密码</span>
			
			</div>
			<form id="myform" method="post" action="{:U('Home/User/changePwd_bgd')}">
				<ul class="zh_message">
					<li>
						<span class="l">旧密码：</span>
						<span class="r"><input type="password" class="required" name="oldpassword" id="old_pwd" /></span>
					</li>
					<li>
						<span class="l">新密码：</span>
						<span class="r"><input type="password" class="required"  name="password" id="new_pwd"/></span>
					</li>
					<li>
						<span class="l">确认密码：</span>
						<span class="r"><input type="password"  class="required" name="confirmpwd" id="confirm_pwd"/></span>
					</li>
					
				</ul>
				<p class="mar_t10"><input class="save_btn" type="submit" value=" " id="member_submit"/></p><span id="error" style="display: inline;color: red;margin-left:10px;"></span>
			</form>
	 </div>
</div>
</div>
<script type="text/javascript">
	$(function(){
		$("#member_submit").on("click",function(e){
			e.preventDefault();
			var url = $("#myform").attr("action");
			var data = $("#myform").serialize();

			$.ajax({
				url:url,
				type:"POST",
				data:data,
				success:function(data){
					if(data.result){
						alert("修改成功");
						window.location.href="{:U('Home/User/member')}";

					}else if(data.result == false){
						alert(data.msg);
						return;
					}
				}
			})
		})
	})
</script>
<!--底部公共部分-->
<include file="Index/footer" />